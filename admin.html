<h2>Admin Panel</h2>

<h3>Update Coins</h3>
<input id="silver" placeholder="Silver">
<input id="gold" placeholder="Gold">
<input id="diamond" placeholder="Diamond">
<button onclick="updateCoins()">Publish</button>

<h3>Owner Message</h3>
<textarea id="notice"></textarea>
<button onclick="publish()">Send Alert</button>

<button onclick="logout()">Logout</button>

<script type="module">
import { onAuthStateChanged, signOut } from 
"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { doc, updateDoc, setDoc, serverTimestamp } from 
"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { auth, db } from "./firebase.js";

onAuthStateChanged(auth, async user=>{
  if(!user) location.href="index.html";
});

window.updateCoins=async()=>{
  await updateDoc(doc(db,"Coins","main"),{
    silver:+silver.value,
    gold:+gold.value,
    diamond:+diamond.value,
    updatedAt:serverTimestamp()
  });
  alert("Coins updated");
};

window.publish=async()=>{
  await setDoc(doc(db,"OwnerMessages","latest"),{
    message:notice.value,
    time:serverTimestamp()
  });
  alert("Notice sent");
};

window.logout=()=>signOut(auth);
</script>